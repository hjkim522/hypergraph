Optimize below;
cycle, direct cycle,
multiple edges
